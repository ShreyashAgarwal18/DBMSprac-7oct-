create table library (
library_id int auto_increment primary key,
title varchar(255) not null
);

create table library_audit (
audit_id int auto_increment primary key,
action_type enum('update', 'delete') not null,
library_id int not null,
old_title varchar(255),
action_time timestamp default current_timestamp
);

delimiter //

create trigger before_library_update
before update on library
for each row
begin
insert into library_audit (action_type, library_id, old_title)
values ('update', old.library_id, old.title);
end //

delimiter ;

delimiter //

create trigger before_library_delete
before delete on library
for each row
begin
insert into library_audit (action_type, library_id, old_title)
values ('delete', old.library_id, old.title);
end //

delimiter ;

insert into library (title)
values ('to kill a mockingbird');

update library
set title = '1984'
where title = 'to kill a mockingbird';

delete from library
where title = '1984';

select * from library_audit;
